!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Gifffer",[],e):"object"==typeof exports?exports.Gifffer=e():t.Gifffer=e()}(this,function(){if("undefined"!=typeof window&&"undefined"!=typeof document){var t=document,e=60;return function(e){var i,r=0,o=[];for(i=t.querySelectorAll("[data-gifffer]");r<i.length;++r)n(i[r],o,e);return o}}function i(t){var e="";for(prop in t)e+=prop+":"+t[prop]+";";return e}function r(r,n,o,d,a){var l,p=t.createElement("BUTTON"),s=o.getAttribute("class"),f=o.getAttribute("id"),h=a&&a.playButtonStyles?i(a.playButtonStyles):["width:"+e+"px","height:"+e+"px","border-radius:"+e/2+"px","background:rgba(0, 0, 0, 0.3)","position:absolute","top:50%","left:50%","margin:-"+e/2+"px"].join(";"),u=a&&a.playButtonIconStyles?i(a.playButtonIconStyles):["width: 0","height: 0","border-top: 14px solid transparent","border-bottom: 14px solid transparent","border-left: 14px solid rgba(0, 0, 0, 0.5)","position: absolute","left: 26px","top: 16px"].join(";");s&&p.setAttribute("class",o.getAttribute("class")),f&&p.setAttribute("id",o.getAttribute("id")),p.setAttribute("style","position:relative;cursor:pointer;background:none;border:none;padding:0;"),p.setAttribute("aria-hidden","true");var g=t.createElement("DIV");g.setAttribute("class","gifffer-play-button"),g.setAttribute("style",h);var c=t.createElement("DIV");return c.setAttribute("style",u),g.appendChild(c),d&&((l=t.createElement("p")).setAttribute("class","gifffer-alt"),l.setAttribute("style","border:0;clip:rect(0 0 0 0);height:1px;overflow:hidden;padding:0;position:absolute;width:1px;"),l.innerText=d+", image"),p.appendChild(g),o.parentNode.replaceChild(p,o),d&&p.parentNode.insertBefore(l,p.nextSibling),{c:p,p:g}}function n(t,e,i){var n,o,d,a,l,p,s,f,h,u,g,c,b,y=!1;n=t.getAttribute("data-gifffer"),a=t.getAttribute("data-gifffer-width"),l=t.getAttribute("data-gifffer-height"),p=t.getAttribute("data-gifffer-duration"),b=t.getAttribute("data-gifffer-alt"),t.style.display="block",d=document.createElement("canvas"),u=!(!d.getContext||!d.getContext("2d")),a&&l&&u&&(h=r(0,0,t,b,i)),t.onload=function(){u&&(a=a||t.width,l=l||t.height,h||(h=r(0,0,t,b,i)),o=h.c,s=h.p,c=function(t,e,i,r,n){var o=t.parentNode.offsetWidth,d=(t.parentNode.offsetHeight,r/n);return e.toString().indexOf("%")>0?i=(e=(e=parseInt(e.toString().replace("%","")))/100*o)/d:i.toString().indexOf("%")>0&&(e=(i=(i=parseInt(i.toString().replace("%","")))/100*o)*d),{w:e,h:i}}(o,a,l,t.width,t.height),e.push(o),o.addEventListener("click",function(){clearTimeout(g),y?(y=!1,o.appendChild(s),o.removeChild(f),o.appendChild(d),f=null):(y=!0,(f=document.createElement("IMG")).setAttribute("style","width:100%;height:100%;"),f.setAttribute("data-uri",Math.floor(1e5*Math.random())+1),setTimeout(function(){f.src=n},0),o.removeChild(s),o.removeChild(d),o.appendChild(f),parseInt(p)>0&&(g=setTimeout(function(){y=!1,o.appendChild(s),o.removeChild(f),o.appendChild(d),f=null},p)))}),d.width=c.w,d.height=c.h,d.getContext("2d").drawImage(t,0,0,c.w,c.h),o.appendChild(d),o.setAttribute("style","position:relative;cursor:pointer;width:"+c.w+"px;height:"+c.h+"px;background:none;border:none;padding:0;"),d.style.width="100%",d.style.height="100%",a.toString().indexOf("%")>0&&l.toString().indexOf("%")>0?(o.style.width=a,o.style.height=l):a.toString().indexOf("%")>0?(o.style.width=a,o.style.height="inherit"):l.toString().indexOf("%")>0?(o.style.width="inherit",o.style.height=l):(o.style.width=c.w+"px",o.style.height=c.h+"px"))},t.src=n}});