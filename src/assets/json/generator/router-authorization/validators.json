{"rightSidebarLinks":[{"id":"router-authorization","title":"router-authorization","subLink":null},{"id":"authorization","title":"Authorization","subLink":[{"title":"Page Level Authorization","id":"pagelevelauthorization","thirdLevelLink":[]}]},{"id":"theuserroleobject","title":"The User Role Object","subLink":[]},{"id":"theglobalresolver","title":"The Global Resolver","subLink":[]},{"id":"pagewiseaccessprovided","title":"Page wise access provided","subLink":[{"title":"Component Level Authorization","id":"componentlevelauthorization","thirdLevelLink":[]}]},{"id":"childcomponentauthorization","title":"Child Component Authorization","subLink":[]},{"id":"componentwiseaccessprovided","title":"Component wise access provided","subLink":[{"title":"Control Level Authorization","id":"controllevelauthorization","thirdLevelLink":[]}]}],"title":"Router authorization","description":"","validatorType":"validators","validationTypeTitle":"Validators","type":"simple","gitDocPath":"https://github.com/rxweb/rxweb.io/edit/master/docs/angular/routes/router-authorization.md","category":"router","subCategory":"","linkTitle":"router-authorization","tabArray":{},"innerHtml":null,"htmlContent":"<div class='row page-section' id= 'authorization'>\r\n<div class='col-lg-12'>\r\n<h2>Authorization<a title='Link to this heading' class='link-header' href='/router/router-authorization/validators#authorization'><i class='fa fa-link'></i></a></h2>\r\n\r\n<p class='showHideElement' >In every enterprise application there is a need of role based authorization to resolve the rights of the particular user to the application based upon the role after the user has logged-in </p>\r\n<p class='showHideElement' >Lets consider a scenario where the application has a candidate module which contains two component candidate add, list. The list component have few shared components. Lets understand the page level authorization for the list component, further we will discuss component level and control level authorization</p>\r\n</div></div>\r\n<div class='row page-section' id= 'pagelevelauthorization'>\r\n<div class='col-lg-12'>\r\n<h3>Page Level Authorization<a title='Link to this heading' class='link-header' href='/router/router-authorization/validators#pagelevelauthorization'><i class='fa fa-link'></i></a></h3>\r\n\r\n<video controls>\r\n<source src=\"assets/rxwebcore/Images/rxweb-authorization-1.mp4\" type=\"video/mp4\">\r\n</video>\r\n<p class='showHideElement' >Page level authorization is required when some pages need to be accessed only by some specific users which are retrieved based upon the role of the user and the module(unit) of the application, In this case the page is accessed to logged-in user based upon the Json Schema retrieved from the server ad below </p>\r\n</div></div>\r\n<div class='row page-section' id= 'theuserroleobject'>\r\n<div class='col-lg-12'>\r\n<h2>The User Role Object<a title='Link to this heading' class='link-header' href='/router/router-authorization/validators#theuserroleobject'><i class='fa fa-link'></i></a></h2>\r\n\r\n<p class='showHideElement' >This resolved authorization object which returns a json schema as below :</p>\r\n<div component=\"app-code\" key=\"authorization-router-json\"></div> \r\n<p class='showHideElement' >In this json result, 1 is the Id of the application module along with the read, write, update and delete access to the user. Application modules are the units of the application </p>\r\n<blockquote class='showHideElement' ><p>You can change the schema based upon your application role management object. </p></blockquote>\r\n</div></div>\r\n<div class='row page-section' id= 'theglobalresolver'>\r\n<div class='col-lg-12'>\r\n<h2>The Global Resolver<a title='Link to this heading' class='link-header' href='/router/router-authorization/validators#theglobalresolver'><i class='fa fa-link'></i></a></h2>\r\n\r\n<p class='showHideElement' ><span class='highlighted'>@rxweb/angular-router</span> provides a mechanism to resolve the page access of the user globally whenever the route navigation takes place.  </p>\r\n<p class='showHideElement' >To achieve this we need to create a class named <span class='highlighted'>AuthorizationResolver</span> which implements the interface <span class='highlighted'>IAuthorize</span> to add the methods to resolve the user access object . </p>\r\n<p class='showHideElement' >Next we need to create a method <span class='highlighted'>authorize</span> which returns the user access from the server based upon the application module Id and the action type which is verified in the <span class='highlighted'>verifyAuthorization</span> method where the <span class='highlighted'>AuthorizeConfig</span> configuration's  access level is the module Id and action type(get, post). </p>\r\n<p class='showHideElement' >The business logic to fetch the user data based upon the schema is written in the below method, In this example the data is retrieved from the user-access.json file.</p>\r\n<p class='showHideElement' >The Authentication Resolver class is as below : </p>\r\n<div component=\"app-code\" key=\"authorization-router-component\"></div> \r\n<p class='showHideElement' >Next we need to add the AuthorizationResolver class in the authorization parameter of <span class='highlighted'>@routerModule</span> decorator at the root level module to make it globally accessible </p>\r\n<div component=\"app-code\" key=\"authorization-router-model\"></div> \r\n</div></div>\r\n<div class='row page-section' id= 'pagewiseaccessprovided'>\r\n<div class='col-lg-12'>\r\n<h2>Page wise access provided<a title='Link to this heading' class='link-header' href='/router/router-authorization/validators#pagewiseaccessprovided'><i class='fa fa-link'></i></a></h2>\r\n\r\n<p class='showHideElement' >In this example there is a candidate list page whenever the admin user logs-in this page is accessed and the candidate list can be seen and whenever HR user logs-in the page is not accessed and the non authorized page is loaded.  </p>\r\n<p class='showHideElement' >Next in the component class we need to add the <span class='highlighted'>@access</span> decorator, The access level is the Id of the application module or the unit of the application where the authorization is applied and the action type which specifies on which action the authorization object should be resolved, The usage of this decorator is shown in the below component of candidate</p>\r\n<div component=\"app-code\" key=\"authorization-candidate-component\"></div> \r\n<p class='showHideElement' >The standard approach of angular uses the <span class='highlighted'>canActivate</span> gaurd to determine the accessibility according to the role after the route is called and this leads to creation of mutiple canActivate which is difficult to manage in large applications. But here we will manage this using a single <span class='highlighted'>BaseCanActivate</span> used thoroughly in the application using decorators in the component for component level authorization</p>\r\n<p class='showHideElement' >In the candidate routing file, we need to pass the <span class='highlighted'>BaseCanActivate</span> along with the route in canActivate parameter as shown here</p>\r\n<div component=\"app-code\" key=\"authorization-candidate-routing\"></div> \r\n<p class='showHideElement' >So far we have finished the implementation of page level access based upon the logged-in user access. Here is the working example have a</p>\r\n<div class=\"stackbltiz-link\"> \r\n<a target=\"_blank\" class=\"redirect-link\" href=\"https://stackblitz.com/edit/router-authorization-e8dq1f?file=src/app/security/authorization-resolver.ts\">Stackblitz</a>\r\n</div>\r\n</div></div>\r\n<div class='row page-section' id= 'componentlevelauthorization'>\r\n<div class='col-lg-12'>\r\n<h3>Component Level Authorization<a title='Link to this heading' class='link-header' href='/router/router-authorization/validators#componentlevelauthorization'><i class='fa fa-link'></i></a></h3>\r\n\r\n<video controls>\r\n<source src=\"assets/rxwebcore/Images/rxweb-authorization-2.mp4\" type=\"video/mp4\">\r\n</video>\r\n<p class='showHideElement' >In every application there are shared component/smart component which are the sub module of the main module, These are basically used as the selector in the application for these shared components the access is further kept to another level where it is sub divided based upon the role, If we talk about the candidate page which has a new candidate add form which is the child module of candidate</p>\r\n</div></div>\r\n<div class='row page-section' id= 'childcomponentauthorization'>\r\n<div class='col-lg-12'>\r\n<h2>Child Component Authorization<a title='Link to this heading' class='link-header' href='/router/router-authorization/validators#childcomponentauthorization'><i class='fa fa-link'></i></a></h2>\r\n\r\n<p class='showHideElement' >In this case we need to create a <span class='highlighted'>authorizeChildren</span> method in the same AuthorizationResolver class which we created earlier to resolve the user access object, this method is used to resolve the access of the child module.</p>\r\n<div component=\"app-code\" key=\"authorization-router-sharedcomponent\"></div> \r\n</div></div>\r\n<div class='row page-section' id= 'componentwiseaccessprovided'>\r\n<div class='col-lg-12'>\r\n<h2>Component wise access provided<a title='Link to this heading' class='link-header' href='/router/router-authorization/validators#componentwiseaccessprovided'><i class='fa fa-link'></i></a></h2>\r\n\r\n<p class='showHideElement' >The CandidateAddComponent which uses the @access decorator to specify the authorization is as below :</p>\r\n<div component=\"app-code\" key=\"authorization-router-candidateaddcomponent\"></div> \r\n<p class='showHideElement' >This component is authorized in the candidatelist component,The shared component is authorized which the help of *rxAuthorize template which includes the name of the component based upon which the authorization needs to be performed. </p>\r\n<p class='showHideElement' >Candidate List Html: </p>\r\n<div component=\"app-code\" key=\"authorization-router-candidatelisthtml\"></div>\r\n<p class='showHideElement' >Candidate List Component:</p>\r\n<div component=\"app-code\" key=\"authorization-router-candidatelistcomponent\"></div>\r\n<p class='showHideElement' >The example is as below:</p>\r\n<div class=\"stackbltiz-link\"> \r\n<a target=\"_blank\" class=\"redirect-link\" href=\"https://stackblitz.com/edit/router-authorization-child-level-authorization?file=src/app/dashboard.component.html\">Stackblitz</a>\r\n</div>\r\n</div></div>\r\n<div class='row page-section' id= 'controllevelauthorization'>\r\n<div class='col-lg-12'>\r\n<h3>Control Level Authorization<a title='Link to this heading' class='link-header' href='/router/router-authorization/validators#controllevelauthorization'><i class='fa fa-link'></i></a></h3>\r\n\r\n<video controls>\r\n<source src=\"assets/rxwebcore/Images/router-control-level-new.mp4\" type=\"video/mp4\">\r\n</video>\r\n<p class='showHideElement' >While performing some operations on a certain entity there are some controls which need to be restricted from certain users, For example in the skill entity of the candidate module there is a control of add in which based upon the plus icon click event the skill can be added, This control needs to be authorized based upon the user role.</p>\r\n<p class='showHideElement' >This can be done using <span class='highlighted'>*rxAuthorize</span> in which the add component will be passed as the parameter value as shown in this html code</p>\r\n<div component=\"app-code\" key=\"authorization-candidate-html\"></div> \r\n<p class='showHideElement' >The candidateAvailabilityAdd is the property whose value will be assigned in the component as the CandidateAvailabilityAddComponent, The authorization of the add button will be done based upon the access object retrieved from the candidate availability add component.</p>\r\n<div component=\"app-code\" key=\"authorization-candidate-controlcomponent\"></div> \r\n<p class='showHideElement' >Control level authorization example :</p>\r\n<div class=\"stackbltiz-link\"> \r\n<a target=\"_blank\" class=\"redirect-link\" href=\"https://stackblitz.com/edit/router-authorization-control-level?file=src/app/candidate-list/candidate-list.component.ts\">Stackblitz</a>\r\n</div>\r\n</div></div>\r\n"}